---           
layout: post
title: Using org.eclipse.ui.menu 3.3 API for popup menu
date: 2009-05-09 18:57:47 UTC
updated: 2009-05-09 18:57:47 UTC
comments: false
categories: Eclipse Popup
---
 
I am not sure <span style="font-style:italic;">new</span> qualifier still apply for an API available since Eclipse 3.3, but here are some questions I have asked myself and for which I would like to share some answers. <br /><br /><ul><li>Where can I find a good introduction to the new API ?<br /></li></ul><br />There is a <a href="http://www.ibm.com/developerworks/library/os-eclipse-3.3menu/index.html">great IBM article</a> ideal to discover the API.<br /><br /><ul><li>Where can I find id for group ?</li></ul><br />Have a look at the following interfaces :<br /><span style="font-style:italic;"><br />org.eclipse.ui.IWorkbenchActionConstants</span><br /><span style="font-style:italic;">org.eclipse.ui.navigator.ICommonMenuConstant</span><br /><br /><ul><li>Where can I find available variables ?</li></ul><br />On the Eclipse <a href="http://wiki.eclipse.org/Command_Core_Expressions">wiki</a>.<br /><br /><ul><li>Where can I find an eclipse plug-in example ?</li></ul><br />In one <a href="http://www.eclipse.org/m2m/atl/">ATL</a> plug-in for instance. Here is an <a href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.m2m/org.eclipse.m2m.atl/plugins/org.eclipse.m2m.atl.adt.ui/plugin.xml?root=Modeling_Project&amp;view=markup">example </a> where the popup menu item is displayed only when the active perspective is the right one, and the selected files extension is ecore.<br /><br /><ul><li>How can I get the selection for popup menu ?</li></ul><br />Be careful the selection variable is not the same for classic menu and popup menu.<br />You have to use <font style="font-style: italic;">activeSelectionMenu</font>.<br /><br /><ul><li>How can I do to not display the menu if the selection is empty ?</li></ul><br />You have to use <span style="font-style:italic;">count</span> element.<br /><pre><br /><font size="2"><font face="courier new">&lt;visiblewhen checkenabled="false"&gt;</font><br /><font face="courier new">   &lt;with variable="activeMenuSelection"&gt;</font><br /><font face="courier new">       &lt;iterate operator="and"></font><br /><font face="courier new">         &lt;count value="+"&gt;<br />        &lt;/count&gt;</font><br /></font><font size="2"><font face="courier new">       &lt;/iterate&gt;</font></font><br /><font size="2"><font face="courier new">   &lt;/with&gt;</font></font><br /><font size="2"><font face="courier new">&lt;visiblewhen&gt;</font></font><br /></pre><br /><br /><ul><li>How could I call a test in Java ?</li></ul><br />First you have to create a property tester :<br /><pre><br /><font size="2"><font face="courier new"><br />&lt;extension point="org.eclipse.core.expressions.propertyTesters"&gt;<br /> &lt;propertytester id="com.mycompany.project.tester.MyTester"<br />  type="org.eclipse.gmf.runtime.diagram.ui.editparts.IGraphicalEditPart"<br />  namespace="com.mycompany.project.namespace" properties="isLikeIWant"<br />  class="com.mycompany.project.namespace.MyTesterClass"&gt;<br /> &lt;/propertytester&gt;<br />&lt;/extension&gt;<br /></font></font><br /></pre><br />Then you can use it with <font style="font-style: italic;">test</font> element  :<br /><pre><br /><font size="2"><br /><font face="courier new"><br />  &lt;visiblewhen checkenabled="false"&gt;<br />     &lt;with variable="activeMenuSelection"&gt;<br />        &lt;iterate operator="and"&gt;<br />           &lt;instanceof value="org.eclipse.gmf.runtime.diagram.ui.editparts.IGraphicalEditPart"&gt;&lt;/instanceof&gt;<br />           &lt;test property="com.mycompany.project.namespace.isLikeIWant"&gt;&lt;/test&gt;<br />           &lt;/iterate&gt;<br />    &lt;/with&gt;<br />  &lt;/visiblewhen&gt;<br /></font><br /></font><br /></pre>